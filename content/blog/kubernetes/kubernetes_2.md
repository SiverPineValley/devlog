---
title: '[쿠버네티스 완벽 가이드] 02. 쿠버네티스 소개'
date: 2022-07-19 17:00:00
category: 'kubernetes'
draft: false
---

# 2. 쿠버네티스 소개


쿠버네티스란 컨테이너화된 애플리케이션의 배포, 확장 등을 관리하는 것을 자동화하기 위한 플랫폼(컨테이너 오케스트레이션 엔진)이다. 도커 자체만으로는 여러 호스트로 구성하거나 규모가 큰 서비스 환경에서 시스템을 구축하기 어려우므로, 이러한 오케스트레이션 플랫폼을 이용하는 것이 요즘의 추세이다.


컨테이너 오케스트레이션 엔진에는 도커 외에도, 도커 스웜, 아파치 메소스(Apache mesos) 등이 있지만, 쿠버네티스가 가장 많이 활용된다. 쿠버네티스에서 사용 가능한 런타임도 도커 외에도 다양한 런타임이 사용 가능하다.


## 2.1 쿠버네티스의 활용


컨테이너란 '어떤 애플리케이션을 실행하도록 빌드된 컨테이너 이미지를 기반으로 기동된 워크로드'를 의미한다. 쿠버네티스는 이러한 컨테이너화된 애플리케이션을 쉽게 배포할 수 있는 기능을 지원한다. 하지만, 컨테이너 환경에서도 다음과 같은 과제들이 있다.
쿠버네티스를 활용하면 자동화할 수 있거나 간단한 오퍼레이션으로 해결 가능하다.

- 여러 쿠버네티스 노드 관리
- 컨테이너 스케줄링
- 롤링 업데이트
- 스케일링/오토 스케일링
- 컨테이너 모니터링
- 자동화된 복구
- 서비스 디스커버리
- 로드 밸런싱
- 데이터 관리
- 워크로드 관리
- 로그 관리
- 선언적 코드를 사용한 관리
- 그 외 에코시스템과의 연계 및 확장

### 2.1.1 선언적 코드를 사용한 관리(IaC)


쿠버네티스는 YAML형식이나 JSON 형식으로 작성한 선언적 코드(매니페스트)를 통해 배포하는 컨테이너로 주변 리소스를 관리할 수 있어 IaC(Infrastructure as Code)를 구현할 수 있다. 간단히 말해, YAML이나 JSON과 같은 선언적 코드를 직성하여 시스템 구축이나 관리를 자동화하고 오케스트레이션하는 방법을 지원한다.


### 2.1.2  스케일링/오토 스케일링


쿠버네티스는 컨테이너 클러스터(쿠버네티스 클러스터)를 구성해서 여러 쿠버네티스 노드를 관리한다. 컨테이너 이미지를 기반으로 쿠버네티스 위에 컨테이너를 배포할 때 같은 컨테이너 이미지를 기반으로 한 여러 컨테이너(레플리카)를 배포하면 부하 분산 및 다중화 구조를 만들 수 있다. 부하에 따라서 컨테이너 레플리카 수를 자동으로 늘리거나 줄일(오토 스케일링) 수도 있다.


### 2.1.3 스케줄링


컨테이너를 쿠버네티스 노드에 배포할 때 어떤 쿠버네티스 노드에 배포할 것인지를 결정하는 '스케줄링' 단계가 있다. 어피니티(Affinity)와 안티 어피니티(Anti-Affinity) 기능을 사용하여 컨테이너화된 애플리케이션 워크로드의 특징이나 쿠버네티스 노드의 성능을 기준으로 스케일링할 수 있다.


### 2.1.4 리소스 관리


컨테이너 배치를 위해 지정이 특별히 없을 경우 쿠버네티스 노드의 CPU나 메모리의 여유 리소스 상태에 따라 스케줄링되기 때문에 사용자는 어떤 쿠버네티스 노드에 컨테이너를 배치할지 관리할 필요가 없다. 또한, 리소스 사용 상태에 따라 클러스터 오토 스케일링 기능으로 쿠버네티스 클러스터의 쿠버네티스 노드도 자동으로 추가하거나 삭제할 수 있다.


### 2.1.5 자동화된 복구


다중화(fault tolerant) 관점에서는 쿠버네티스의 중요한 콘셉 중 하나인 자동화된 복구 기능 (self-healing)이 있다. 쿠버네티스는 표준으로 컨테이너 프로세스를 모니터링하고 프로세스의 정지를 감지하면, 다시 컨테이너 스케줄링을 실행하여 자동으로 컨테이너를 재배포한다. 클러스터 노드에 장애가 발생하거나 노드를 축출했을 경우에도 서비스 영향 없이 애플리케이션을 자동으로 북구할 수 있다. 프로세스의 health check는 HTTP/TCP나 쉘 스크립트로 헬스 체크의 성공 여부를 설정할 수도 있다.


### 2.1.6 로드 밸런싱과 디스커버리


여러 대로 구성된 애플리케이션을 하나의 애플리케이션으로 사용자에게 보여주고 접속시키려면 사용자에게 목적지가 되는 여러 대로 구성된 엔드포인트를 준비해야 한다. 쿠버네티스는 로드밸런서 기능을 제공하고 있으며 사전에 정의한 조건과 일치하는 컨테이너 그룹에 라우팅하는 엔드포인트를 할당할 수 있다.


또한, 쿠버네티스는 서비스 디스커버리도 가능하다. 컨테이너를 사용하여 시스템을 구축하는 경우에는 기능별로 독립된 작은 규모의 애플리케이션을 연계하여 시스템을 구현하는 '마이크로서비스 아키텍쳐'를 선택하는 것이 일반적이다. 이런 환경에서 각각의 마이크로서비스가 서로의 마이크로서비스를 참조할 때 서비스 디스커버리 기능은 매우 유용하다. 서비스 디스커버리 기능을 통해 각각의 마이크로서비스가 정의된 복수의 매니페스트를 이용하여 시스템 전체를 쉽게 연계할 수 있다.


### 2.1.7 데이터 관리


쿠버네티스는 백엔드 데이터 스토어로 etcd를 채용하고 있다. etcd는 클러스터를 구성하여 이중화가 가능하고 컨테이너나 서비스의 매니페스트 파일도 이중화 구조로 저장한다. 또, 쿠버네티스는 컨테이너가 사용하는 설정 파일이나 인증 정보 등의 데이터를 저장하는 구조도 가지고 있어 컨테이너 공통 설정이나 애플리케이션에서 사용되는 데이터베이스 인증 정보 등을 안전하고 이중화된 상태로 쿠버네티스에서 집중적으로 관리할 수 있다.


쿠버네티스는 독립적으로 하나의 플랫폼으로 사용할 수 있지만 외부 에코시스템과의 연계도 활발히 이루어지고 있다. 많은 미들웨어들이 쿠버네티스를 지원하며, 이러한 경향은 앞으로도 가속화될 것이다. 아래는 미들웨어들에 대한 소개이다.


- Ansible: 쿠버네티스에 컨테이너 배포
- Apache Ignite: 쿠버네티스 서비스 디스커버리를 사용한 클러스터 생성과 스케일링
- Fluentd: 쿠버네티스에 컨테이너 로그 전송
- GitLab: CI/CD를 구현하기 위한 일련의 다양한 도구와 쿠버네티스의 통합
- Jenkins: 잡 실행 시 잡 실행자용 컨테이너를 쿠버네티스에 배포
- OpenStack: 클라우드 사업자와 연계한 쿠버네티스 구축
- Prometheus: 쿠버네티스 모니터링
- Spark: 잡을 쿠버네티스에서 네이티브로 실행(YARN 대체)
- Spinnaker: 쿠버네티스에 컨테이버 배포
- Kubeflow: 쿠버네티스에 ML 플랫폼 배포
- Rook: 쿠버네티스에 분산 파일 시스템 배포
- Vitess: 쿠버네티스에 MySQL 클러스터 배포

